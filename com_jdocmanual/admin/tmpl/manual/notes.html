<h2 id="installation-notes">Installation Notes</h2>
<p>Jdocmanual is designed to deliver Joomla documentation in an easy to
use reference form. It can also be used for other custom
documentation.</p>
<p>Jdocmanual consists of two parts:</p>
<ul>
<li>The Jdocmanual component code and an optional plugin to provide CLI
access.</li>
<li>Data files for each available Manual and Language. There are four
manuals and eight languages available. You only need one to get started
but the process is so easy you may as well get the English data for all
manuals.</li>
</ul>
<p>Version 4 of Jdocmanual is not compatible with previous versions. Any
previous version should have the #__jdm_articles and #__jdm_menus tables
emptied.</p>
<h2 id="jdocmanual-installation">Jdocmanual Installation</h2>
<p>Install and enable Jdocmanual as you would any other Joomla
extension. It can be obtained from:</p>
<p>https://github.com/ceford/cefjdemos-com-jdm</p>
<p>Select the green <strong>Code</strong> button and then the
<strong>Download ZIP</strong> item. Save the ZIP file in your Downloads
directory. In your Joomla installation select System &gt; Install &gt;
Extensions and then select the <strong>Upload Package File</strong>
tab.</p>
<p>You will also need the Jdocmanualcli plugin. It used to run data
installation commands from the command line with a little more
flexibility than the Jdocmanual component within Joomla. It can be
obtained from:</p>
<p>https://github.com/ceford/cefjdemos-plg-jdocmanualcli</p>
<p>Install and enable the plugin.</p>
<h2 id="data-files">Data Files</h2>
<p>The data files should be located in your filespace but outside your
website tree. The parent directory must be named
<strong>Manuals</strong>. This is a suggested Linux structure:</p>
<div class="sourceCode" id="cb1"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="ex">/home/username/manuals/developer/</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="ex">/home/username/manuals/docs/</span></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="ex">/home/username/manuals/help/</span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="ex">/home/username/manuals/user/</span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="ex">/home/username/public_html</span> <span class="er">(</span><span class="ex">where</span> your Joomla website is located<span class="kw">)</span></span></code></pre></div>
<p>Obtain the English data files for each manual from the GitHub. You
can download ZIP files or use git clone.</p>
<p>This is a set of commands to use for git clone for English and
German:</p>
<div class="sourceCode" id="cb2"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>    <span class="bu">cd</span> /home/username</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>    <span class="ex">mdkdir</span> manuals</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>    <span class="bu">cd</span> manuals</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mkdir</span> developer</span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mkdir</span> docs</span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mkdir</span> help</span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mkdir</span> user</span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a>    <span class="bu">cd</span> help</span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">git</span> clone https://github.com/ceford/cefjdemos-data-jdm-help-en</span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mv</span> cefjdemos-data-jdm-help-en en</span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a>    <span class="fu">git</span> clone https://github.com/ceford/cefjdemos-data-jdm-help-de</span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mv</span> cefjdemos-data-jdm-help-de de</span>
<span id="cb2-15"><a href="#cb2-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-16"><a href="#cb2-16" aria-hidden="true" tabindex="-1"></a>    <span class="bu">cd</span> ../developer</span>
<span id="cb2-17"><a href="#cb2-17" aria-hidden="true" tabindex="-1"></a>    <span class="fu">git</span> clone https://github.com/ceford/cefjdemos-data-jdm-developer-en</span>
<span id="cb2-18"><a href="#cb2-18" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mv</span> cefjdemos-data-jdm-developer-en en</span>
<span id="cb2-19"><a href="#cb2-19" aria-hidden="true" tabindex="-1"></a>    <span class="fu">git</span> clone https://github.com/ceford/cefjdemos-data-jdm-developer-de</span>
<span id="cb2-20"><a href="#cb2-20" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mv</span> cefjdemos-data-jdm-developer-de de</span>
<span id="cb2-21"><a href="#cb2-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-22"><a href="#cb2-22" aria-hidden="true" tabindex="-1"></a>    <span class="bu">cd</span> ../docs</span>
<span id="cb2-23"><a href="#cb2-23" aria-hidden="true" tabindex="-1"></a>    <span class="fu">git</span> clone https://github.com/ceford/cefjdemos-data-jdm-docs-en</span>
<span id="cb2-24"><a href="#cb2-24" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mv</span> cefjdemos-data-jdm-docs-en en</span>
<span id="cb2-25"><a href="#cb2-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-26"><a href="#cb2-26" aria-hidden="true" tabindex="-1"></a>    <span class="bu">cd</span> ../user</span>
<span id="cb2-27"><a href="#cb2-27" aria-hidden="true" tabindex="-1"></a>    <span class="fu">git</span> clone https://github.com/ceford/cefjdemos-data-jdm-user-en</span>
<span id="cb2-28"><a href="#cb2-28" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mv</span> cefjdemos-data-jdm-user-en en</span>
<span id="cb2-29"><a href="#cb2-29" aria-hidden="true" tabindex="-1"></a>    <span class="fu">git</span> clone https://github.com/ceford/cefjdemos-data-jdm-user-de</span>
<span id="cb2-30"><a href="#cb2-30" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mv</span> cefjdemos-data-jdm-user-de de</span></code></pre></div>
<p>These are the links to download ZIP files in English:</p>
<ul>
<li>https://github.com/ceford/cefjdemos-data-jdm-developer-en</li>
<li>https://github.com/ceford/cefjdemos-data-jdm-docs-en</li>
<li>https://github.com/ceford/cefjdemos-data-jdm-help-en</li>
<li>https://github.com/ceford/cefjdemos-data-jdm-user-en</li>
</ul>
<p>Unpack each in its appropriate directory. For example, unpack the
…/user/en data set in the manuals/user/ directory. You will get a folder
with the same name as the repository</p>
<p><strong>Change the name of the folder</strong> to the
<strong>language</strong> abbreviation. You should end up with a
directory structure like this:</p>
<div class="sourceCode" id="cb3"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="ex">/home/username/manuals/user/en/articles/</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="ex">/home/username/manuals/user/en/images/</span></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a><span class="ex">/home/username/manuals/user/en/articles-index.txt</span></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a><span class="ex">/home/username/manuals/user/en/menus-index.txt</span></span></code></pre></div>
<p>If you add data for another language it will follow the same pattern,
except that the articles-index.txt and menus-index.txt files are only
present in the in the <strong>/en/</strong> folder.</p>
<h2 id="jdocmanual-configuration">Jdocmanual Configuration</h2>
<p>From the Administrator menu open the Jdocmanual &gt; Manual page.
Until the component is properly configured you will see this
<strong>Installation Notes</strong> page.</p>
<ul>
<li>Select the <strong>Options</strong> button in the Toolbar.</li>
<li>Enter the full path to the data files, ending in
<strong>manuals/</strong>. For example:</li>
</ul>
<div class="sourceCode" id="cb4"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="ex">/home/username/manuals/</span></span></code></pre></div>
<ul>
<li>If your website is in a sub-directory then enter the sub-directory
name with a leading slash, for example /jdm4.</li>
<li>Save &amp; Close</li>
</ul>
<h2 id="enable-manuals-and-build-articles-and-menus">Enable Manuals and
Build Articles and Menus</h2>
<p>The four Manuals available for Jdocmanual are included in the
database but not enabled. The procedure for each manual is the same as
this example for the User Manual:</p>
<ul>
<li>Select <strong>Components &gt; Manuals &gt; Sources</strong> from
the Administrator menu.</li>
<li>Select the <strong>Jooomla User Manual</strong> to open its Edit
page.</li>
<li>Change the <em>Status</em> to <strong>Published</strong> and
<strong>Save</strong></li>
<li>In the <em>Sources</em> page the table of manuals has a language
selector in the row for each language. Select a language to build the
database tables for that manual and language. The first time this is
done the process may take a long time and the only indicator is busy
icon in the browser tab. Be patient for 5 minutes or so. Jdocmanual will
build the articles and menus in the selected language and it will create
responsive images in a variety of sizes. There will be a summary
message, which may include problem reports. On the next invocation the
build process will be much quicker as only changed pages are
rebuilt.</li>
<li>For the <em>Help</em> Manual only, the build process also builds the
proxy server used to deliver help pages. This is very quick and is done
for all installed languages. To use it, edit your configuration.php and
change the <code>$helpurl</code> domain name to that of this Joomla
installation.</li>
</ul>
<h2 id="test">Test</h2>
<ul>
<li>Select <strong>Components &gt; Manuals &gt; Manuals</strong> from
the Administrator menu.</li>
</ul>
<p>You should see the first page of the User Manual.</p>
<h2 id="maintenance">Maintenance</h2>
<p>From time to time there will be updates to the Jdocmanual data files.
You can download the source files and repeat the data installation
process. This is very easy to do with <strong>git</strong>: just do
<code>git pull</code> in the appropriate language folder, then use the
Build selector in the Sources page or switch to the <em>cli</em> folder
and run the cli commands. You can build a cron job to do this.</p>
<h2 id="build-articles-and-menus---command-line-method">Build Articles
and Menus - Command Line Method</h2>
<p>The database jdm_articles and jdm_menus tables are populated by
reading the data files. This can take a long time - at least a few of
minutes and perhaps much longer on slow hosts.</p>
<p>Proceed as follows:</p>
<ol type="1">
<li>Open a terminal window and cd into the cli folder within your Joomla
installation root. Here is an example:
<code>cd /home/username/public_html/optional-subfolder/cli</code></li>
<li>Issue the command to convert data from the markdown source files to
html in the #__jdm_articles table of the database:<br>
<code>php joomla.php jdocmanual:action buildarticles user en</code></li>
<li>Issue the command to create the menus:<br>
<code>php joomla.php jdocmanual:action buildmenus user en</code></li>
</ol>
<p>In these commands, <strong>user</strong> is the name of the manual to
be processed and <strong>en</strong> is a language specifier.</p>
<p>The Markdown format is converted to HTML and stored in the database.
Also, if there are any images in the data source a set of responsive
images is created.</p>
<p>If you encounter <strong>out of memory</strong> problems or
<strong>out of time</strong> problems …</p>
<h2 id="database-population---cron-method">Database Population - Cron
Method</h2>
<p>If you do not have access to the command line, common with shared
hosting, you should be able to call these commands from a cron job. Make
sure you give the full path to the php executable, example:
<code>/usr/local/opt/php@8.1/bin/php</code>. You need to find out where
the php executable is located on your host operating system.</p>
<h2 id="site-menu">Site Menu</h2>
<p>If you want to show the Manuals on the site just create a JDOC Manual
menu item. Note the single page is for search results but it has not
been implemented.</p>
<p><strong>Important:</strong> The menu alias must be
<strong>jdocmanual</strong> or internal links will be broken and lead to
frontend problems.</p>
<p>You may wish to place the menu on a page without side modules so that
the full width of the page may be used for content.</p>
<h2 id="multilingual-sites">Multilingual Sites</h2>
<p>The <strong>System - Language Filter</strong> plugin must have the
<strong>Remove URL Language Code</strong> set to <strong>Yes</strong> or
frontend local images will not display and internal links will be
broken.</p>
<h2 id="user-groups">User Groups</h2>
<p>If you wish to allow others to help maintain content you need to
create two User Groups:</p>
<ul>
<li><strong>JDM Author</strong>: allowed to edit content in English and
other languages.</li>
<li><strong>JDM Publisher</strong>: allowed to commit and publish
updated content.</li>
</ul>
<p>The <strong>JDM Author</strong> group should have Public as its
parent. The <strong>JDM Publisher</strong> group should have <strong>JDM
Author</strong> as its parent.</p>
<h3 id="users-viewing-access-levels">Users: Viewing Access Levels</h3>
<p><strong>JDM Author</strong> should be set to the Special Viewing
Access level. From the Users / Access Levels page select
<code>Special</code> and add <code>JDM Author</code> to the User Groups
with Viewing Access.</p>
<h3 id="global-options">Global Options</h3>
<p>In the Global Options form select the Permissions tab and then the
<strong>JDM Author</strong> item. Set Administrator login to
Allowed.</p>
<h3 id="jdocmanual-options">Jdocmanual Options</h3>
<p>From the JDOC Manual, Manual page select the Options button. In the
Permissions list select <strong>JDM Author</strong> and set the
following to Allowed: - Access Administration Interface - Create -
Delete - Edit</p>
<p>Select <strong>JDM Publisher</strong> and set the following to
Allowed: - Publish</p>
<p>Save and Close</p>
<p>If you now login as a user in the <strong>JDM Author</strong> group
you will see the Home Dashboard with some modules not relevant for
Jdocmanual.</p>
<h3 id="turn-off-the-help-menu-item">Turn off the Help menu item</h3>
<p>Go to the list of Administrator modules and find the Administrator
Menu module. In the Module tab set the Help Menu item to Hide.</p>
<h3 id="unpublish-or-restrict-access-to-modules">Unpublish or restrict
Access to modules</h3>
<p>In the Administrator modules list find the Logged-in Users item used
in the cpanel position (not the cpanel-users position). Either Unpublish
it or set Access to Super Users.</p>
<p>Find and unpublish the Popular Articles and Recently Added Articles
items for the cpanel position (not the cpanel-content position).</p>
<p>There may be other modules needing similar treatment.</p>
<p>The Home Dashboard should now be empty for a <strong>JDM
Author</strong>.</p>
<h2 id="who-can-do-what">Who can do what?</h2>
<p><strong>JDM Author</strong> and <strong>JDM Publisher</strong> can
login but should only have access to the the Home Dashboard and the
Jdocmanual component.</p>
<p><strong>JDM Author</strong> does not have access to the Commit button
in the Article Edit page toolbar so cannot update the git repository or
displayed page. Otherwise each can use all other features.</p>
<p><strong>Manager</strong> and <strong>Administrator</strong> can login
but will not see the Jdocmanual component.</p>
<p><strong>Author</strong>, <strong>Editor</strong> and
<strong>Publisher</strong> do not have access to the Administrator
interface.</p>
<p><strong>Super Users</strong> have complete access.</p>
<h2 id="some-reminders">Some Reminders</h2>
<p>The System - Joomla Accessibility Checker flags the anchors as having
empty links. So comment out line 70 of
administrator/components/com_jdocmanual/libraries/vendor/league/commonmark/src/Extension/HeadingPermalink/HeadingPermalinkRenderer.php</p>
<div class="sourceCode" id="cb5"><pre
class="sourceCode php"><code class="sourceCode php"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>        <span class="co">//$attrs-&gt;set(&#39;href&#39;, &#39;#&#39; . $fragmentPrefix . $slug);</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>        <span class="va">$attrs</span>-&gt;append(<span class="st">&#39;class&#39;</span><span class="ot">,</span> <span class="va">$this</span>-&gt;config-&gt;get(<span class="st">&#39;heading_permalink/html_class&#39;</span>))<span class="ot">;</span></span></code></pre></div>
